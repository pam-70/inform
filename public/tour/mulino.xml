<?xml version="1.0" encoding="UTF-8"?>
<!-- for xml compliance -->
<!-- Generated By Kolor Panotour 1.8.0 -->
<krpano version="1.0.8.14" logkey="false" onstart="startaction">
    <action name="startaction">
		hidepanospotsaction();
	</action>
    <action name="mainloadpano">
		closepanoobjects();
		closeglobalobjects();
		ifnot(stopSequence === undefined,interruptAnimation(););
		loadpano(%1,NULL,NULL,BLEND(1));
	</action>
    <!--************** KrPano plugins and datas ***************************************************-->
    <plugin name="data" firstPanoHasBeenPlayed="false" introImageHasBeenPlayed="false" soundOn="true" keep="true"/>
    <!--************** Open the first pano ********************************************************-->
    <include url="mulino30.xml"/>
    <autorotate enabled="false"/>
    <plugin name="soundinterface" preload="true" url="mulinodata/graphics/soundinterface.swf" keep="true"/>
    <action name="playsoundaction">
		set(plugin[data].soundOn, true);
		playpanosounds(forcesounds);
	</action>
    <action name="stopsoundaction">
		set(plugin[data].soundOn, false);
		stoppanosounds();
	</action>
    <!--************** Fonts **********************************************************************-->
    <textstyle name="DEFAULT" bold="false" font="Arial Narrow" fontsize="16" italic="false" textcolor="0xff000000"/>
    <!--************** Introduction ***************************************************************-->
    <action name="fromlittleplanetintrotonormalview">
		tweennormalview();
		showpanospotsaction();
	</action>
    <action name="firstloadcompleteaction">
		if(plugin[data].firstPanoHasBeenPlayed==false,
			setlittleplanet();
			wait(load);
			set(plugin[data].firstPanoHasBeenPlayed,true);
			if (plugin[data].introImageHasBeenPlayed == true, startLittlePlanetIntroEffect(););
		);
	</action>
    <action name="startLittlePlanetIntroEffect">
		if(plugin[data].firstPanoHasBeenPlayed == true,
			delayedcall(1.0,
				fromlittleplanetintrotonormalview();
				set(autorotate.enabled,true);
			);
		);
	</action>
    <action name="setlittleplanet">
		set(view.stereographic, true);
		set(view.fisheye      , 1.0);
		set(view.limitview    , lookat);
		set(view.vlookatmin   , -90);
		set(view.vlookatmax   , 90);
		set(view.fov          , 150);
		set(view.fovmax       , 150);
		set(view.hlookat      , 0);
		set(view.vlookat      , 90);
		set(display.flash10   , off);
		set(display.details   , 14);
	</action>
    <plugin name="introimage" url="mulinodata/graphics/introImage.png" align="center" onclick="hideintroimage();" onloaded="autohideintroimage();"/>
    <action name="hideintroimage">
		if(plugin[introimage].enabled,	set(plugin[introimage].enabled,false);tween(plugin[introimage].alpha, 0.0, 0.5, default, removeplugin(introimage)););
		startLittlePlanetIntroEffect();
	</action>
    <action name="autohideintroimage">
		if(plugin[data].introImageHasBeenPlayed==false, 	set(plugin[introimage].alpha,0); tween(plugin[introimage].alpha,1.0,WAIT);
		delayedcall(5, hideintroimage() ); 
		set(plugin[data].introImageHasBeenPlayed,true););
	</action>
    <!--************** Logos **********************************************************************-->
    <plugin name="logo4" url="mulinodata/graphics/logo4.png" keep="true" align="rightbottom" x="10" y="10" width="100" height="130" onclick="openurl(http://www.mulino58.ru ,_blank)"/>
    <!--************** Menu ***********************************************************************-->
    <plugin name="in" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(fov_moveforce,-1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(fov_moveforce,0);" url="mulinodata/graphics/menu/menu0.png" width="40" x="-180" y="10"/>
    <plugin name="out" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(fov_moveforce,+1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(fov_moveforce,0);" url="mulinodata/graphics/menu/menu1.png" width="40" x="-140" y="10"/>
    <plugin name="left" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(hlookat_moveforce,-1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(hlookat_moveforce,0);" url="mulinodata/graphics/menu/menu2.png" width="40" x="-100" y="10"/>
    <plugin name="right" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(hlookat_moveforce,+1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(hlookat_moveforce,0);" url="mulinodata/graphics/menu/menu3.png" width="40" x="-60" y="10"/>
    <plugin name="up" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(vlookat_moveforce,-1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(vlookat_moveforce,0);" url="mulinodata/graphics/menu/menu4.png" width="40" x="-20" y="10"/>
    <plugin name="down" align="bottom" crop="0|0|65|65" height="prop" keep="true" ondown="set(vlookat_moveforce,+1);" onout="" onover="" onovercrop="0|65|65|65" onup="set(vlookat_moveforce,0);" url="mulinodata/graphics/menu/menu5.png" width="40" x="20" y="10"/>
    <plugin name="home" align="bottom" crop="0|0|65|65" height="prop" keep="true" onclick="lookto(get(panoview.h),get(panoview.v),get(panoview.fov),smooth(100,20,50));" onout="" onover="" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu6.png" width="40" x="60" y="10"/>
    <plugin name="openfs" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="set(fullscreen,true);" onout="" onover="" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu7.png" width="40" x="100" y="10"/>
    <plugin name="closefs" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="set(fullscreen,false);" onout="" onover="" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu8.png" visible="false" width="40" x="100" y="10"/>
    <plugin name="soundON" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="playsoundaction();set(plugin[soundON].visible,false); set(plugin[soundOFF].visible,true);" onout="" onover="" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu9.png" visible="false" width="40" x="140" y="10"/>
    <plugin name="soundOFF" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="stopsoundaction();set(plugin[soundOFF].visible,false); set(plugin[soundON].visible,true);" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu10.png" visible="true" width="40" x="140" y="10"/>
    <plugin name="autorotationON" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="switch(autorotate.enabled);set(plugin[autorotationON].visible,false); set(plugin[autorotationOFF].visible,true);" onout="" onover="" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu11.png" visible="" width="40" x="180" y="10"/>
    <plugin name="autorotationOFF" align="bottom" blendmode="normal" crop="0|0|65|65" customColor="true" height="prop" keep="true" onclick="switch(autorotate.enabled);set(plugin[autorotationOFF].visible,false); set(plugin[autorotationON].visible,true);" onovercrop="0|65|65|65" url="mulinodata/graphics/menu/menu12.png" visible="" width="40" x="180" y="10"/>
    <events onenterfullscreen="set(plugin[openfs].visible,false); set(plugin[closefs].visible,true);" onexitfullscreen="set(plugin[openfs].visible,true); set(plugin[closefs].visible,false);"/>
    <!--************** Plugin map *****************************************************************-->
    <plugin name="map" url="mulinodata/map/map.jpg" keep="true" align="leftbottom" x="10" y="10" width="150" height="60" handcursor="false" onloaded="hidemapspot();" onclick="openmap"/>
    <plugin keep="true" visible="false" name="mapspot0" onclick="mainloadpano(mulino30.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(главный вход);" align="lefttop" edge="center" parent="map" x="41.9459%" y="66.3014%"/>
    <plugin keep="true" visible="false" name="mapspot1" onclick="mainloadpano(mulino1.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(рекреация 1 этаж);" align="lefttop" edge="center" parent="map" x="32.973%" y="79.726%"/>
    <plugin keep="true" visible="false" name="mapspot2" onclick="mainloadpano(mulino2.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(учительская);" align="lefttop" edge="center" parent="map" x="36.7486%" y="83.6695%"/>
    <plugin keep="true" visible="false" name="mapspot3" onclick="mainloadpano(mulino0.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(вход 2);" align="lefttop" edge="center" parent="map" x="46.7675%" y="31.0279%"/>
    <plugin keep="true" visible="false" name="mapspot4" onclick="mainloadpano(mulino6.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(рекреация начальной школы);" align="lefttop" edge="center" parent="map" x="44.1588%" y="85.2065%"/>
    <plugin keep="true" visible="false" name="mapspot5" onclick="mainloadpano(mulino3.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(рекреация начальной школы);" align="lefttop" edge="center" parent="map" x="27.5614%" y="88.2805%"/>
    <plugin keep="true" visible="false" name="mapspot6" onclick="mainloadpano(mulino4.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 113);" align="lefttop" edge="center" parent="map" x="42.5709%" y="91.1623%"/>
    <plugin keep="true" visible="false" name="mapspot7" onclick="mainloadpano(mulino5.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(спальная комната);" align="lefttop" edge="center" parent="map" x="47.2968%" y="91.0663%"/>
    <plugin keep="true" visible="false" name="mapspot8" onclick="mainloadpano(mulino11.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(столовая);" align="lefttop" edge="center" parent="map" x="29.7543%" y="38.5207%"/>
    <plugin keep="true" visible="false" name="mapspot9" onclick="mainloadpano(mulino9.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(большой спортзал);" align="lefttop" edge="center" parent="map" x="33.7618%" y="21.902%"/>
    <plugin keep="true" visible="false" name="mapspot10" onclick="mainloadpano(mulino10.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(бассейн большой);" align="lefttop" edge="center" parent="map" x="17.1267%" y="38.9049%"/>
    <plugin keep="true" visible="false" name="mapspot11" onclick="mainloadpano(mulino8.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(центральная лестница);" align="lefttop" edge="center" parent="map" x="37.6181%" y="31.1239%"/>
    <plugin keep="true" visible="false" name="mapspot12" onclick="mainloadpano(mulino12.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(мастерские);" align="lefttop" edge="center" parent="map" x="41.0208%" y="48.511%"/>
    <plugin keep="true" visible="false" name="mapspot13" onclick="mainloadpano(mulino28.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет кулинария);" align="lefttop" edge="center" parent="map" x="31.4178%" y="60.4227%"/>
    <plugin keep="true" visible="false" name="mapspot14" onclick="mainloadpano(mulino13.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" align="lefttop" edge="center" parent="map" x="64.8015%" y="41.3064%"/>
    <plugin keep="true" visible="false" name="mapspot15" onclick="mainloadpano(mulino14.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(музей 1);" align="lefttop" edge="center" parent="map" x="56.2949%" y="37.3679%"/>
    <plugin keep="true" visible="false" name="mapspot16" onclick="mainloadpano(mulino15.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(музей 2);" align="lefttop" edge="center" parent="map" x="49.9055%" y="37.3679%"/>
    <plugin keep="true" visible="false" name="mapspot17" onclick="mainloadpano(mulino7.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(рекреация 2 этаж);" align="lefttop" edge="center" parent="map" x="58.4877%" y="29.683%"/>
    <plugin keep="true" visible="false" name="mapspot18" onclick="mainloadpano(mulino16.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 262. ОБЖ);" align="lefttop" edge="center" parent="map" x="55.9546%" y="46.7819%"/>
    <plugin keep="true" visible="false" name="mapspot19" onclick="mainloadpano(mulino17.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 201. физика);" align="lefttop" edge="center" parent="map" x="56.4083%" y="60.0384%"/>
    <plugin keep="true" visible="false" name="mapspot20" onclick="mainloadpano(mulino27.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(библиотека);" align="lefttop" edge="center" parent="map" x="74.4423%" y="41.6907%"/>
    <plugin keep="true" visible="false" name="mapspot21" onclick="mainloadpano(mulino26.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 306. химия);" align="lefttop" edge="center" parent="map" x="81.5123%" y="66.3785%"/>
    <plugin keep="true" visible="false" name="mapspot22" onclick="mainloadpano(mulino18.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 314. математика);" align="lefttop" edge="center" parent="map" x="77.6938%" y="92.123%"/>
    <plugin keep="true" visible="false" name="mapspot23" onclick="mainloadpano(mulino19.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 315. английский язык);" align="lefttop" edge="center" parent="map" x="82.0416%" y="90.8742%"/>
    <plugin keep="true" visible="false" name="mapspot24" onclick="mainloadpano(mulino20.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет психологической разгрузки);" align="lefttop" edge="center" parent="map" x="89.7543%" y="90.4899%"/>
    <plugin keep="true" visible="false" name="mapspot25" onclick="mainloadpano(mulino21.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 332. лингафонный);" align="lefttop" edge="center" parent="map" x="91.5312%" y="89.7214%"/>
    <plugin keep="true" visible="false" name="mapspot26" onclick="mainloadpano(mulino22.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 333. история);" align="lefttop" edge="center" parent="map" x="93.8374%" y="90.2978%"/>
    <plugin keep="true" visible="false" name="mapspot27" onclick="mainloadpano(mulino23.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 331. ИЗО%2C МХК);" align="lefttop" edge="center" parent="map" x="96.2193%" y="90.682%"/>
    <plugin keep="true" visible="false" name="mapspot28" onclick="mainloadpano(mulino24.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 330. информатика);" align="lefttop" edge="center" parent="map" x="98.1096%" y="89.2411%"/>
    <plugin keep="true" visible="false" name="mapspot29" onclick="mainloadpano(mulino25.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(кабинет 323. швейная мастерская);" align="lefttop" edge="center" parent="map" x="97.5425%" y="84.2459%"/>
    <plugin keep="true" visible="false" name="mapspot30" onclick="mainloadpano(mulino29.xml);" url="mulinodata/graphics/spots/spot0.png" blingCounter="0" onhover="showtext(рекреация 3 этаж);" align="lefttop" edge="center" parent="map" x="95.1607%" y="83.5735%"/>
    <plugin name="mapradar" parent="map" edge="center" align="lefttop" keep="true" url="mulinodata/map/radar.swf" visible="false" width="21" height="21" linecolor="0x770001" linealpha="1" linewidth="2" fillcolor="0xff7869" fillalpha="0.568627"/>
    <action name="showmapspot">
		set(  plugin[mapspot0].alpha  , 0);
		set(  plugin[mapspot0].visible, true);
		tween(plugin[mapspot0].alpha  , 1);
		set(  plugin[mapspot1].alpha  , 0);
		set(  plugin[mapspot1].visible, true);
		tween(plugin[mapspot1].alpha  , 1);
		set(  plugin[mapspot2].alpha  , 0);
		set(  plugin[mapspot2].visible, true);
		tween(plugin[mapspot2].alpha  , 1);
		set(  plugin[mapspot3].alpha  , 0);
		set(  plugin[mapspot3].visible, true);
		tween(plugin[mapspot3].alpha  , 1);
		set(  plugin[mapspot4].alpha  , 0);
		set(  plugin[mapspot4].visible, true);
		tween(plugin[mapspot4].alpha  , 1);
		set(  plugin[mapspot5].alpha  , 0);
		set(  plugin[mapspot5].visible, true);
		tween(plugin[mapspot5].alpha  , 1);
		set(  plugin[mapspot6].alpha  , 0);
		set(  plugin[mapspot6].visible, true);
		tween(plugin[mapspot6].alpha  , 1);
		set(  plugin[mapspot7].alpha  , 0);
		set(  plugin[mapspot7].visible, true);
		tween(plugin[mapspot7].alpha  , 1);
		set(  plugin[mapspot8].alpha  , 0);
		set(  plugin[mapspot8].visible, true);
		tween(plugin[mapspot8].alpha  , 1);
		set(  plugin[mapspot9].alpha  , 0);
		set(  plugin[mapspot9].visible, true);
		tween(plugin[mapspot9].alpha  , 1);
		set(  plugin[mapspot10].alpha  , 0);
		set(  plugin[mapspot10].visible, true);
		tween(plugin[mapspot10].alpha  , 1);
		set(  plugin[mapspot11].alpha  , 0);
		set(  plugin[mapspot11].visible, true);
		tween(plugin[mapspot11].alpha  , 1);
		set(  plugin[mapspot12].alpha  , 0);
		set(  plugin[mapspot12].visible, true);
		tween(plugin[mapspot12].alpha  , 1);
		set(  plugin[mapspot13].alpha  , 0);
		set(  plugin[mapspot13].visible, true);
		tween(plugin[mapspot13].alpha  , 1);
		set(  plugin[mapspot14].alpha  , 0);
		set(  plugin[mapspot14].visible, true);
		tween(plugin[mapspot14].alpha  , 1);
		set(  plugin[mapspot15].alpha  , 0);
		set(  plugin[mapspot15].visible, true);
		tween(plugin[mapspot15].alpha  , 1);
		set(  plugin[mapspot16].alpha  , 0);
		set(  plugin[mapspot16].visible, true);
		tween(plugin[mapspot16].alpha  , 1);
		set(  plugin[mapspot17].alpha  , 0);
		set(  plugin[mapspot17].visible, true);
		tween(plugin[mapspot17].alpha  , 1);
		set(  plugin[mapspot18].alpha  , 0);
		set(  plugin[mapspot18].visible, true);
		tween(plugin[mapspot18].alpha  , 1);
		set(  plugin[mapspot19].alpha  , 0);
		set(  plugin[mapspot19].visible, true);
		tween(plugin[mapspot19].alpha  , 1);
		set(  plugin[mapspot20].alpha  , 0);
		set(  plugin[mapspot20].visible, true);
		tween(plugin[mapspot20].alpha  , 1);
		set(  plugin[mapspot21].alpha  , 0);
		set(  plugin[mapspot21].visible, true);
		tween(plugin[mapspot21].alpha  , 1);
		set(  plugin[mapspot22].alpha  , 0);
		set(  plugin[mapspot22].visible, true);
		tween(plugin[mapspot22].alpha  , 1);
		set(  plugin[mapspot23].alpha  , 0);
		set(  plugin[mapspot23].visible, true);
		tween(plugin[mapspot23].alpha  , 1);
		set(  plugin[mapspot24].alpha  , 0);
		set(  plugin[mapspot24].visible, true);
		tween(plugin[mapspot24].alpha  , 1);
		set(  plugin[mapspot25].alpha  , 0);
		set(  plugin[mapspot25].visible, true);
		tween(plugin[mapspot25].alpha  , 1);
		set(  plugin[mapspot26].alpha  , 0);
		set(  plugin[mapspot26].visible, true);
		tween(plugin[mapspot26].alpha  , 1);
		set(  plugin[mapspot27].alpha  , 0);
		set(  plugin[mapspot27].visible, true);
		tween(plugin[mapspot27].alpha  , 1);
		set(  plugin[mapspot28].alpha  , 0);
		set(  plugin[mapspot28].visible, true);
		tween(plugin[mapspot28].alpha  , 1);
		set(  plugin[mapspot29].alpha  , 0);
		set(  plugin[mapspot29].visible, true);
		tween(plugin[mapspot29].alpha  , 1);
		set(  plugin[mapspot30].alpha  , 0);
		set(  plugin[mapspot30].visible, true);
		tween(plugin[mapspot30].alpha  , 1);
	</action>
    <action name="hidemapspot">
		set(plugin[mapspot0].visible,false);
		set(plugin[mapspot1].visible,false);
		set(plugin[mapspot2].visible,false);
		set(plugin[mapspot3].visible,false);
		set(plugin[mapspot4].visible,false);
		set(plugin[mapspot5].visible,false);
		set(plugin[mapspot6].visible,false);
		set(plugin[mapspot7].visible,false);
		set(plugin[mapspot8].visible,false);
		set(plugin[mapspot9].visible,false);
		set(plugin[mapspot10].visible,false);
		set(plugin[mapspot11].visible,false);
		set(plugin[mapspot12].visible,false);
		set(plugin[mapspot13].visible,false);
		set(plugin[mapspot14].visible,false);
		set(plugin[mapspot15].visible,false);
		set(plugin[mapspot16].visible,false);
		set(plugin[mapspot17].visible,false);
		set(plugin[mapspot18].visible,false);
		set(plugin[mapspot19].visible,false);
		set(plugin[mapspot20].visible,false);
		set(plugin[mapspot21].visible,false);
		set(plugin[mapspot22].visible,false);
		set(plugin[mapspot23].visible,false);
		set(plugin[mapspot24].visible,false);
		set(plugin[mapspot25].visible,false);
		set(plugin[mapspot26].visible,false);
		set(plugin[mapspot27].visible,false);
		set(plugin[mapspot28].visible,false);
		set(plugin[mapspot29].visible,false);
		set(plugin[mapspot30].visible,false);
	</action>
    <!-- close the map -->
    <action name="closemap">
		set(plugin[mapradar].visible,false);
		hidemapspot();
		set(plugin[map].onclick,openmap);
		set(plugin[map].width, 150);
		set(plugin[map].height, 60);
		set(plugin[map].align, leftbottom);
		set(plugin[map].x    , 10);
		set(plugin[map].y    , 10);
	</action>
    <!-- open the map -->
    <action name="openmap">
		if(plugin[mapradar].shouldbevisible == true, set(plugin[mapradar].visible,true););
		set(plugin[map].onclick, closemap);
		tween(plugin[map].height, 356, 0.5, easeoutquad);
		tween(plugin[map].width , 900, 0.5, easeoutquad, showmapspot(););
		set(plugin[map].align, center);
		set(plugin[map].x    , 0);
		set(plugin[map].y    , 0);
	</action>
    <!-- Убрать выделение всех точек карты, кроме тех, что переданы параметрами -->
    <!-- Убрать выделение всех точек карты, если параметр не задан -->
    <action name="unselectmapspotsbutpassed">
		set(plugin[mapradar].visible        , false);
		set(plugin[mapradar].shouldbevisible, false);
		if (%1 != mapspot0,
				if(plugin[mapspot0].animated,
				set(plugin[mapspot0].frame           , 0);
				set(plugin[mapspot0].ypos            , 0);
				set(plugin[mapspot0].animationCounter, 0)
				txtadd(plugin[mapspot0].crop,'0|0|',get(plugin[mapspot0].framewidth),'|',get(plugin[mapspot0].frameheight));
			,
				set(plugin[mapspot0].blingCounter, 0)
			)
		);
		resetmapspot(mapspot0);
		if (%1 != mapspot1,
				if(plugin[mapspot1].animated,
				set(plugin[mapspot1].frame           , 0);
				set(plugin[mapspot1].ypos            , 0);
				set(plugin[mapspot1].animationCounter, 0)
				txtadd(plugin[mapspot1].crop,'0|0|',get(plugin[mapspot1].framewidth),'|',get(plugin[mapspot1].frameheight));
			,
				set(plugin[mapspot1].blingCounter, 0)
			)
		);
		resetmapspot(mapspot1);
		if (%1 != mapspot2,
				if(plugin[mapspot2].animated,
				set(plugin[mapspot2].frame           , 0);
				set(plugin[mapspot2].ypos            , 0);
				set(plugin[mapspot2].animationCounter, 0)
				txtadd(plugin[mapspot2].crop,'0|0|',get(plugin[mapspot2].framewidth),'|',get(plugin[mapspot2].frameheight));
			,
				set(plugin[mapspot2].blingCounter, 0)
			)
		);
		resetmapspot(mapspot2);
		if (%1 != mapspot3,
				if(plugin[mapspot3].animated,
				set(plugin[mapspot3].frame           , 0);
				set(plugin[mapspot3].ypos            , 0);
				set(plugin[mapspot3].animationCounter, 0)
				txtadd(plugin[mapspot3].crop,'0|0|',get(plugin[mapspot3].framewidth),'|',get(plugin[mapspot3].frameheight));
			,
				set(plugin[mapspot3].blingCounter, 0)
			)
		);
		resetmapspot(mapspot3);
		if (%1 != mapspot4,
				if(plugin[mapspot4].animated,
				set(plugin[mapspot4].frame           , 0);
				set(plugin[mapspot4].ypos            , 0);
				set(plugin[mapspot4].animationCounter, 0)
				txtadd(plugin[mapspot4].crop,'0|0|',get(plugin[mapspot4].framewidth),'|',get(plugin[mapspot4].frameheight));
			,
				set(plugin[mapspot4].blingCounter, 0)
			)
		);
		resetmapspot(mapspot4);
		if (%1 != mapspot5,
				if(plugin[mapspot5].animated,
				set(plugin[mapspot5].frame           , 0);
				set(plugin[mapspot5].ypos            , 0);
				set(plugin[mapspot5].animationCounter, 0)
				txtadd(plugin[mapspot5].crop,'0|0|',get(plugin[mapspot5].framewidth),'|',get(plugin[mapspot5].frameheight));
			,
				set(plugin[mapspot5].blingCounter, 0)
			)
		);
		resetmapspot(mapspot5);
		if (%1 != mapspot6,
				if(plugin[mapspot6].animated,
				set(plugin[mapspot6].frame           , 0);
				set(plugin[mapspot6].ypos            , 0);
				set(plugin[mapspot6].animationCounter, 0)
				txtadd(plugin[mapspot6].crop,'0|0|',get(plugin[mapspot6].framewidth),'|',get(plugin[mapspot6].frameheight));
			,
				set(plugin[mapspot6].blingCounter, 0)
			)
		);
		resetmapspot(mapspot6);
		if (%1 != mapspot7,
				if(plugin[mapspot7].animated,
				set(plugin[mapspot7].frame           , 0);
				set(plugin[mapspot7].ypos            , 0);
				set(plugin[mapspot7].animationCounter, 0)
				txtadd(plugin[mapspot7].crop,'0|0|',get(plugin[mapspot7].framewidth),'|',get(plugin[mapspot7].frameheight));
			,
				set(plugin[mapspot7].blingCounter, 0)
			)
		);
		resetmapspot(mapspot7);
		if (%1 != mapspot8,
				if(plugin[mapspot8].animated,
				set(plugin[mapspot8].frame           , 0);
				set(plugin[mapspot8].ypos            , 0);
				set(plugin[mapspot8].animationCounter, 0)
				txtadd(plugin[mapspot8].crop,'0|0|',get(plugin[mapspot8].framewidth),'|',get(plugin[mapspot8].frameheight));
			,
				set(plugin[mapspot8].blingCounter, 0)
			)
		);
		resetmapspot(mapspot8);
		if (%1 != mapspot9,
				if(plugin[mapspot9].animated,
				set(plugin[mapspot9].frame           , 0);
				set(plugin[mapspot9].ypos            , 0);
				set(plugin[mapspot9].animationCounter, 0)
				txtadd(plugin[mapspot9].crop,'0|0|',get(plugin[mapspot9].framewidth),'|',get(plugin[mapspot9].frameheight));
			,
				set(plugin[mapspot9].blingCounter, 0)
			)
		);
		resetmapspot(mapspot9);
		if (%1 != mapspot10,
				if(plugin[mapspot10].animated,
				set(plugin[mapspot10].frame           , 0);
				set(plugin[mapspot10].ypos            , 0);
				set(plugin[mapspot10].animationCounter, 0)
				txtadd(plugin[mapspot10].crop,'0|0|',get(plugin[mapspot10].framewidth),'|',get(plugin[mapspot10].frameheight));
			,
				set(plugin[mapspot10].blingCounter, 0)
			)
		);
		resetmapspot(mapspot10);
		if (%1 != mapspot11,
				if(plugin[mapspot11].animated,
				set(plugin[mapspot11].frame           , 0);
				set(plugin[mapspot11].ypos            , 0);
				set(plugin[mapspot11].animationCounter, 0)
				txtadd(plugin[mapspot11].crop,'0|0|',get(plugin[mapspot11].framewidth),'|',get(plugin[mapspot11].frameheight));
			,
				set(plugin[mapspot11].blingCounter, 0)
			)
		);
		resetmapspot(mapspot11);
		if (%1 != mapspot12,
				if(plugin[mapspot12].animated,
				set(plugin[mapspot12].frame           , 0);
				set(plugin[mapspot12].ypos            , 0);
				set(plugin[mapspot12].animationCounter, 0)
				txtadd(plugin[mapspot12].crop,'0|0|',get(plugin[mapspot12].framewidth),'|',get(plugin[mapspot12].frameheight));
			,
				set(plugin[mapspot12].blingCounter, 0)
			)
		);
		resetmapspot(mapspot12);
		if (%1 != mapspot13,
				if(plugin[mapspot13].animated,
				set(plugin[mapspot13].frame           , 0);
				set(plugin[mapspot13].ypos            , 0);
				set(plugin[mapspot13].animationCounter, 0)
				txtadd(plugin[mapspot13].crop,'0|0|',get(plugin[mapspot13].framewidth),'|',get(plugin[mapspot13].frameheight));
			,
				set(plugin[mapspot13].blingCounter, 0)
			)
		);
		resetmapspot(mapspot13);
		if (%1 != mapspot14,
				if(plugin[mapspot14].animated,
				set(plugin[mapspot14].frame           , 0);
				set(plugin[mapspot14].ypos            , 0);
				set(plugin[mapspot14].animationCounter, 0)
				txtadd(plugin[mapspot14].crop,'0|0|',get(plugin[mapspot14].framewidth),'|',get(plugin[mapspot14].frameheight));
			,
				set(plugin[mapspot14].blingCounter, 0)
			)
		);
		resetmapspot(mapspot14);
		if (%1 != mapspot15,
				if(plugin[mapspot15].animated,
				set(plugin[mapspot15].frame           , 0);
				set(plugin[mapspot15].ypos            , 0);
				set(plugin[mapspot15].animationCounter, 0)
				txtadd(plugin[mapspot15].crop,'0|0|',get(plugin[mapspot15].framewidth),'|',get(plugin[mapspot15].frameheight));
			,
				set(plugin[mapspot15].blingCounter, 0)
			)
		);
		resetmapspot(mapspot15);
		if (%1 != mapspot16,
				if(plugin[mapspot16].animated,
				set(plugin[mapspot16].frame           , 0);
				set(plugin[mapspot16].ypos            , 0);
				set(plugin[mapspot16].animationCounter, 0)
				txtadd(plugin[mapspot16].crop,'0|0|',get(plugin[mapspot16].framewidth),'|',get(plugin[mapspot16].frameheight));
			,
				set(plugin[mapspot16].blingCounter, 0)
			)
		);
		resetmapspot(mapspot16);
		if (%1 != mapspot17,
				if(plugin[mapspot17].animated,
				set(plugin[mapspot17].frame           , 0);
				set(plugin[mapspot17].ypos            , 0);
				set(plugin[mapspot17].animationCounter, 0)
				txtadd(plugin[mapspot17].crop,'0|0|',get(plugin[mapspot17].framewidth),'|',get(plugin[mapspot17].frameheight));
			,
				set(plugin[mapspot17].blingCounter, 0)
			)
		);
		resetmapspot(mapspot17);
		if (%1 != mapspot18,
				if(plugin[mapspot18].animated,
				set(plugin[mapspot18].frame           , 0);
				set(plugin[mapspot18].ypos            , 0);
				set(plugin[mapspot18].animationCounter, 0)
				txtadd(plugin[mapspot18].crop,'0|0|',get(plugin[mapspot18].framewidth),'|',get(plugin[mapspot18].frameheight));
			,
				set(plugin[mapspot18].blingCounter, 0)
			)
		);
		resetmapspot(mapspot18);
		if (%1 != mapspot19,
				if(plugin[mapspot19].animated,
				set(plugin[mapspot19].frame           , 0);
				set(plugin[mapspot19].ypos            , 0);
				set(plugin[mapspot19].animationCounter, 0)
				txtadd(plugin[mapspot19].crop,'0|0|',get(plugin[mapspot19].framewidth),'|',get(plugin[mapspot19].frameheight));
			,
				set(plugin[mapspot19].blingCounter, 0)
			)
		);
		resetmapspot(mapspot19);
		if (%1 != mapspot20,
				if(plugin[mapspot20].animated,
				set(plugin[mapspot20].frame           , 0);
				set(plugin[mapspot20].ypos            , 0);
				set(plugin[mapspot20].animationCounter, 0)
				txtadd(plugin[mapspot20].crop,'0|0|',get(plugin[mapspot20].framewidth),'|',get(plugin[mapspot20].frameheight));
			,
				set(plugin[mapspot20].blingCounter, 0)
			)
		);
		resetmapspot(mapspot20);
		if (%1 != mapspot21,
				if(plugin[mapspot21].animated,
				set(plugin[mapspot21].frame           , 0);
				set(plugin[mapspot21].ypos            , 0);
				set(plugin[mapspot21].animationCounter, 0)
				txtadd(plugin[mapspot21].crop,'0|0|',get(plugin[mapspot21].framewidth),'|',get(plugin[mapspot21].frameheight));
			,
				set(plugin[mapspot21].blingCounter, 0)
			)
		);
		resetmapspot(mapspot21);
		if (%1 != mapspot22,
				if(plugin[mapspot22].animated,
				set(plugin[mapspot22].frame           , 0);
				set(plugin[mapspot22].ypos            , 0);
				set(plugin[mapspot22].animationCounter, 0)
				txtadd(plugin[mapspot22].crop,'0|0|',get(plugin[mapspot22].framewidth),'|',get(plugin[mapspot22].frameheight));
			,
				set(plugin[mapspot22].blingCounter, 0)
			)
		);
		resetmapspot(mapspot22);
		if (%1 != mapspot23,
				if(plugin[mapspot23].animated,
				set(plugin[mapspot23].frame           , 0);
				set(plugin[mapspot23].ypos            , 0);
				set(plugin[mapspot23].animationCounter, 0)
				txtadd(plugin[mapspot23].crop,'0|0|',get(plugin[mapspot23].framewidth),'|',get(plugin[mapspot23].frameheight));
			,
				set(plugin[mapspot23].blingCounter, 0)
			)
		);
		resetmapspot(mapspot23);
		if (%1 != mapspot24,
				if(plugin[mapspot24].animated,
				set(plugin[mapspot24].frame           , 0);
				set(plugin[mapspot24].ypos            , 0);
				set(plugin[mapspot24].animationCounter, 0)
				txtadd(plugin[mapspot24].crop,'0|0|',get(plugin[mapspot24].framewidth),'|',get(plugin[mapspot24].frameheight));
			,
				set(plugin[mapspot24].blingCounter, 0)
			)
		);
		resetmapspot(mapspot24);
		if (%1 != mapspot25,
				if(plugin[mapspot25].animated,
				set(plugin[mapspot25].frame           , 0);
				set(plugin[mapspot25].ypos            , 0);
				set(plugin[mapspot25].animationCounter, 0)
				txtadd(plugin[mapspot25].crop,'0|0|',get(plugin[mapspot25].framewidth),'|',get(plugin[mapspot25].frameheight));
			,
				set(plugin[mapspot25].blingCounter, 0)
			)
		);
		resetmapspot(mapspot25);
		if (%1 != mapspot26,
				if(plugin[mapspot26].animated,
				set(plugin[mapspot26].frame           , 0);
				set(plugin[mapspot26].ypos            , 0);
				set(plugin[mapspot26].animationCounter, 0)
				txtadd(plugin[mapspot26].crop,'0|0|',get(plugin[mapspot26].framewidth),'|',get(plugin[mapspot26].frameheight));
			,
				set(plugin[mapspot26].blingCounter, 0)
			)
		);
		resetmapspot(mapspot26);
		if (%1 != mapspot27,
				if(plugin[mapspot27].animated,
				set(plugin[mapspot27].frame           , 0);
				set(plugin[mapspot27].ypos            , 0);
				set(plugin[mapspot27].animationCounter, 0)
				txtadd(plugin[mapspot27].crop,'0|0|',get(plugin[mapspot27].framewidth),'|',get(plugin[mapspot27].frameheight));
			,
				set(plugin[mapspot27].blingCounter, 0)
			)
		);
		resetmapspot(mapspot27);
		if (%1 != mapspot28,
				if(plugin[mapspot28].animated,
				set(plugin[mapspot28].frame           , 0);
				set(plugin[mapspot28].ypos            , 0);
				set(plugin[mapspot28].animationCounter, 0)
				txtadd(plugin[mapspot28].crop,'0|0|',get(plugin[mapspot28].framewidth),'|',get(plugin[mapspot28].frameheight));
			,
				set(plugin[mapspot28].blingCounter, 0)
			)
		);
		resetmapspot(mapspot28);
		if (%1 != mapspot29,
				if(plugin[mapspot29].animated,
				set(plugin[mapspot29].frame           , 0);
				set(plugin[mapspot29].ypos            , 0);
				set(plugin[mapspot29].animationCounter, 0)
				txtadd(plugin[mapspot29].crop,'0|0|',get(plugin[mapspot29].framewidth),'|',get(plugin[mapspot29].frameheight));
			,
				set(plugin[mapspot29].blingCounter, 0)
			)
		);
		resetmapspot(mapspot29);
		if (%1 != mapspot30,
				if(plugin[mapspot30].animated,
				set(plugin[mapspot30].frame           , 0);
				set(plugin[mapspot30].ypos            , 0);
				set(plugin[mapspot30].animationCounter, 0)
				txtadd(plugin[mapspot30].crop,'0|0|',get(plugin[mapspot30].framewidth),'|',get(plugin[mapspot30].frameheight));
			,
				set(plugin[mapspot30].blingCounter, 0)
			)
		);
		resetmapspot(mapspot30);
	</action>
    <!-- Выделить конкретную точку карты -->
    <action name="selectmapspot">
		unselectmapspotsbutpassed(%1);
		if(plugin[%1].animated,
			inc(plugin[%1].animationCounter, 1);
			if(plugin[%1].animationCounter == 1,
				animatemapspot(%1, 0.1);
			);
		,
			inc(plugin[%1].blingCounter,1);
			if(plugin[%1].blingCounter == 1,
				blingmapspot(%1);
			);
		);
		copy(plugin[mapradar].x              , plugin[%1].x);
		copy(plugin[mapradar].y              , plugin[%1].y);
		set( plugin[mapradar].heading        , %2          );
		set( plugin[mapradar].shouldbevisible, true        );
		if(plugin[map].onclick == closemap, set(plugin[mapradar].visible,true););
	</action>
    <!-- make map hotspots flash when selected (recursive action) -->
    <action name="blingmapspot">
		tween(plugin[%1].alpha, 0.0, 0.8, easeInSine  );
		tween(plugin[%1].scale, 1.5, 0.8, easeOutCubic);
		tween(, , 0.8, , resetmapspot(%1);
		if(plugin[%1].blingCounter &gt; 0, blingmapspot(%1);););
	</action>
    <action name="resetmapspot">
		set(plugin[%1].scale,1);
		set(plugin[%1].alpha,1);
	</action>
    <!--************** Background sound ***********************************************************-->
    <action name="playbackgroundsound">
		if(%1 == none,
			stopallsounds();
			set(plugin[soundinterface].background,%1);
			,
			if(plugin[soundinterface].background == %1,
				if (%3 == forcesounds,
					stopallsounds();playsound(backgroundsound,%1,%2);
				)
				,
				stopallsounds();playsound(backgroundsound,%1,%2);
				set(plugin[soundinterface].background,%1);
			)
		);
	</action>
    <action name="stopbackgroundsound">
		stopsound(backgroundsound);
	</action>
    <!--************** Sequence animation *********************************************************-->
    <action name="animate">
		if (stopSequence == false,
			inc(hotspot[%1].frame,1,get(hotspot[%1].lastframe),0);
			mul(hotspot[%1].ypos,hotspot[%1].frame,hotspot[%1].frameheight);
			txtadd(hotspot[%1].crop,'0|',get(hotspot[%1].ypos),'|',get(hotspot[%1].framewidth),'|',get(hotspot[%1].frameheight));
			delayedcall(%2, animate(%1,%2) );
		);
	</action>
    <action name="closeglobalobjects">
		closemap();
	</action>
    <!-- Raise sequence stopper and wait sequence time to break the delayed calls -->
    <action name="interruptAnimation">
		ifnot (stopSequence === undefined,
			set(stopSequence, true);
			wait(0.1);
		);
	</action>
</krpano>